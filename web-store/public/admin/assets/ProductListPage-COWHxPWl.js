import{a as s,j as e,L as N,h as T,i as _,f as y,e as S,k as z,E as F,l as I,z as a}from"./index-B7VyGmnV.js";import{g as $}from"./categoryService-xXKv2Z8A.js";import{g as M,d as q,a as O,u as R}from"./productService-Dr9A4P09.js";import{T as B}from"./triangle-alert-MYTYNX-z.js";import{T as P}from"./trash-2-erq2rAW7.js";import{P as G,S as H}from"./square-pen-DGeCmu33.js";function X(){const[g,C]=s.useState([]),[E,L]=s.useState([]),[r,A]=s.useState(0),[c,n]=s.useState(1),[x,j]=s.useState(""),[u,f]=s.useState(""),[m,b]=s.useState(!0),[p,v]=s.useState(!1),d=20,i=s.useCallback(async()=>{b(!0);try{const{data:t,count:o}=await M({search:x,category_id:u||void 0,page:c,limit:d});C(t),A(o)}finally{b(!1)}},[x,u,c]);s.useEffect(()=>{$().then(L)},[]),s.useEffect(()=>{i()},[i]);const w=async(t,o)=>{if(confirm(`Delete "${o}"? This action cannot be undone.`))try{await q(t),a.success("Product deleted successfully"),i()}catch(l){a.error(l.message||"Failed to delete product"),console.error(l)}},k=async()=>{if(r===0){a.error("No products to delete");return}if(!confirm(`Are you sure you want to delete ALL ${r} products? This action cannot be undone.

Type "DELETE ALL" to confirm.`))return;if(prompt('Type "DELETE ALL" to confirm:')!=="DELETE ALL"){a.error("Deletion cancelled");return}v(!0);try{await O(),a.success(`Successfully deleted all ${r} products`),j(""),f(""),n(1),i()}catch(l){a.error(l.message||"Failed to delete all products"),console.error(l)}finally{v(!1)}},D=async t=>{await R(t.id,{is_active:!t.is_active}),a.success(`Product ${t.is_active?"deactivated":"activated"}`),i()},h=Math.ceil(r/d);return e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h1",{className:"page-header mb-0",children:["Products ",e.jsxs("span",{className:"text-muted-foreground text-lg font-normal",children:["(",r,")"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[r>0&&e.jsx("button",{onClick:k,disabled:p||m,className:"flex items-center gap-2 px-4 py-2 text-sm font-medium rounded-lg border border-destructive/30 text-destructive bg-destructive/10 hover:bg-destructive/20 disabled:opacity-50 disabled:cursor-not-allowed transition-all",children:p?e.jsxs(e.Fragment,{children:[e.jsx(B,{size:16,className:"animate-pulse"}),"Deleting..."]}):e.jsxs(e.Fragment,{children:[e.jsx(P,{size:16}),"Delete All Products"]})}),e.jsxs(N,{to:"/products/new",className:"btn-primary",children:[e.jsx(G,{size:16})," New Product"]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(T,{size:15,className:"absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground"}),e.jsx("input",{value:x,onChange:t=>{j(t.target.value),n(1)},className:"input pl-9",placeholder:"Search products..."})]}),e.jsxs("select",{value:u,onChange:t=>{f(t.target.value),n(1)},className:"select w-auto",children:[e.jsx("option",{value:"",children:"All Categories"}),E.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]})]}),e.jsx("div",{className:"table-container",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Product"}),e.jsx("th",{children:"Category"}),e.jsx("th",{children:"Price"}),e.jsx("th",{children:"Stock"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Created"}),e.jsx("th",{className:"text-right",children:"Actions"})]})}),e.jsxs("tbody",{children:[m&&e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"text-center py-12 text-muted-foreground",children:"Loading..."})}),!m&&g.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"text-center py-12 text-muted-foreground",children:"No products found."})}),g.map(t=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsxs("div",{className:"flex items-center gap-3",children:[t.images?.[0]?e.jsx("img",{src:t.images[0],alt:t.name,className:"w-10 h-10 rounded-md object-cover border border-border shrink-0"}):e.jsx("div",{className:"w-10 h-10 rounded-md bg-secondary border border-border shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-foreground text-sm leading-tight",children:t.name}),t.is_featured&&e.jsxs("span",{className:"flex items-center gap-1 text-[10px] text-accent",children:[e.jsx(_,{size:10,fill:"currentColor"})," Featured"]})]})]})}),e.jsx("td",{children:e.jsx("span",{className:"text-sm text-muted-foreground",children:t.category?.name??"—"})}),e.jsxs("td",{children:[e.jsx("p",{className:"text-sm font-medium text-foreground",children:y(t.price)}),t.original_price&&e.jsx("p",{className:"text-[10px] text-muted-foreground line-through",children:y(t.original_price)})]}),e.jsx("td",{children:e.jsx("span",{className:S("text-sm font-semibold",t.stock===0?"text-red-400":t.stock<10?"text-orange-400":"text-green-400"),children:t.stock})}),e.jsx("td",{children:e.jsx("span",{className:S("badge",t.is_active?"bg-green-500/20 text-green-400 border-green-500/30":"bg-red-500/20 text-red-400 border-red-500/30"),children:t.is_active?"Active":"Inactive"})}),e.jsx("td",{children:e.jsx("span",{className:"text-xs text-muted-foreground",children:z(t.created_at)})}),e.jsx("td",{children:e.jsxs("div",{className:"flex items-center gap-1 justify-end",children:[e.jsx("button",{onClick:()=>D(t),className:"btn-ghost btn-icon",title:t.is_active?"Deactivate":"Activate",children:t.is_active?e.jsx(F,{size:15}):e.jsx(I,{size:15})}),e.jsx(N,{to:`/products/${t.id}/edit`,className:"btn-ghost btn-icon",title:"Edit",children:e.jsx(H,{size:15})}),e.jsx("button",{onClick:()=>w(t.id,t.name),className:"btn-ghost btn-icon text-destructive/70 hover:text-destructive",title:"Delete",children:e.jsx(P,{size:15})})]})})]},t.id))]})]})}),h>1&&e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("p",{className:"text-muted-foreground",children:["Showing ",(c-1)*d+1,"–",Math.min(c*d,r)," of ",r]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>n(t=>Math.max(1,t-1)),disabled:c===1,className:"btn-secondary px-3 py-1.5 text-xs",children:"Prev"}),e.jsx("button",{onClick:()=>n(t=>Math.min(h,t+1)),disabled:c===h,className:"btn-secondary px-3 py-1.5 text-xs",children:"Next"})]})]})]})}export{X as default};
