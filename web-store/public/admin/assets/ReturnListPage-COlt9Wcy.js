import{s as f,a as d,j as e,e as y,n as S,z as C}from"./index-B7VyGmnV.js";async function R(s){const c=s?.page??1,n=s?.limit,i=(c-1)*n;let a=f.from("returns").select(`
      *,
      profile:profiles(full_name),
      order:orders(id, total_amount, status)
    `,{count:"exact"});s?.status&&s.status!=="all"&&(a=a.eq("status",s.status)),a=a.order("created_at",{ascending:!1}).range(i,i+n-1);const{data:u,error:r,count:o}=await a;if(r)throw r;return{data:u??[],count:o??0}}async function w(s,c){const{error:n}=await f.from("returns").update({status:c}).eq("id",s);if(n)throw n}const k=["all","pending","approved","rejected","completed"];function q(){const[s,c]=d.useState([]),[n,i]=d.useState(0),[a,u]=d.useState("all"),[r,o]=d.useState(1),[h,g]=d.useState(!0),j=20,b=d.useCallback(async()=>{g(!0);const{data:t,count:l}=await R({status:a,page:r,limit:j});c(t),i(l),g(!1)},[a,r]);d.useEffect(()=>{b()},[b]);const m=async(t,l)=>{await w(t,l),C.success(`Return ${l}`),c(v=>v.map(p=>p.id===t?{...p,status:l}:p))},x=Math.ceil(n/j),N={pending:"badge-pending",approved:"bg-green-500/20 text-green-400 border-green-500/30",rejected:"badge-cancelled",completed:"bg-slate-500/20 text-slate-400 border-slate-500/30"};return e.jsxs("div",{className:"space-y-5",children:[e.jsxs("h1",{className:"page-header",children:["Return Requests ",e.jsxs("span",{className:"text-muted-foreground text-lg font-normal",children:["(",n,")"]})]}),e.jsx("div",{className:"flex gap-1",children:k.map(t=>e.jsx("button",{onClick:()=>{u(t),o(1)},className:y("px-3 py-1.5 text-xs font-medium rounded-md capitalize transition-colors",a===t?"bg-primary/20 text-primary border border-primary/30":"text-muted-foreground hover:text-foreground hover:bg-secondary"),children:t},t))}),e.jsx("div",{className:"table-container",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Order ID"}),e.jsx("th",{children:"Customer"}),e.jsx("th",{children:"Reason"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Date"}),e.jsx("th",{className:"text-right",children:"Actions"})]})}),e.jsxs("tbody",{children:[h&&e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"text-center py-12 text-muted-foreground",children:"Loading..."})}),!h&&s.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"text-center py-12 text-muted-foreground",children:"No return requests."})}),s.map(t=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsxs("span",{className:"font-mono text-xs text-muted-foreground",children:["#",t.order_id.slice(0,8).toUpperCase()]})}),e.jsx("td",{children:e.jsx("p",{className:"text-sm text-foreground",children:t.profile?.full_name??"Unknown"})}),e.jsxs("td",{children:[e.jsx("p",{className:"text-sm font-medium text-foreground",children:t.reason}),e.jsx("p",{className:"text-xs text-muted-foreground truncate max-w-[160px]",children:t.description})]}),e.jsx("td",{children:e.jsx("span",{className:`badge ${N[t.status]??"badge-pending"} capitalize`,children:t.status})}),e.jsx("td",{children:e.jsx("span",{className:"text-xs text-muted-foreground",children:S(t.created_at)})}),e.jsxs("td",{className:"text-right",children:[t.status==="pending"&&e.jsxs("div",{className:"flex gap-1 justify-end",children:[e.jsx("button",{onClick:()=>m(t.id,"approved"),className:"px-2 py-1 text-xs rounded bg-green-500/20 text-green-400 border border-green-500/30 hover:bg-green-500/30 font-medium",children:"Approve"}),e.jsx("button",{onClick:()=>m(t.id,"rejected"),className:"px-2 py-1 text-xs rounded bg-destructive/20 text-destructive border border-destructive/30 hover:bg-destructive/30 font-medium",children:"Reject"})]}),t.status==="approved"&&e.jsx("button",{onClick:()=>m(t.id,"completed"),className:"px-2 py-1 text-xs rounded bg-slate-500/20 text-slate-400 border border-slate-500/30 hover:bg-slate-500/30 font-medium",children:"Complete"})]})]},t.id))]})]})}),x>1&&e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("p",{className:"text-muted-foreground",children:["Page ",r," of ",x]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>o(t=>Math.max(1,t-1)),disabled:r===1,className:"btn-secondary px-3 py-1.5 text-xs",children:"Prev"}),e.jsx("button",{onClick:()=>o(t=>Math.min(x,t+1)),disabled:r===x,className:"btn-secondary px-3 py-1.5 text-xs",children:"Next"})]})]})]})}export{q as default};
