import{a as t,j as e,h as y,e as S,k as _,L as k,l as w,z as C}from"./index-B7VyGmnV.js";import{g as R,S as U,a as z,u as L}from"./userService-CfcbAx6N.js";function A(){const[m,h]=t.useState([]),[r,f]=t.useState(0),[i,g]=t.useState(""),[n,N]=t.useState("all"),[a,d]=t.useState(1),[u,j]=t.useState(!0),c=20,p=t.useCallback(async()=>{j(!0);const{data:s,count:l}=await R({search:i,role:n==="all"?void 0:n,page:a,limit:c});h(s),f(l),j(!1)},[i,n,a]);t.useEffect(()=>{p()},[p]);const b=async s=>{const l=s.role==="admin"?"customer":"admin";confirm(`Change ${s.full_name}'s role to "${l}"?`)&&(await L(s.user_id,l),C.success(`Role updated to ${l}`),h(v=>v.map(x=>x.user_id===s.user_id?{...x,role:l}:x)))},o=Math.ceil(r/c);return e.jsxs("div",{className:"space-y-5",children:[e.jsxs("h1",{className:"page-header",children:["Users ",e.jsxs("span",{className:"text-muted-foreground text-lg font-normal",children:["(",r,")"]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(y,{size:15,className:"absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground"}),e.jsx("input",{value:i,onChange:s=>{g(s.target.value),d(1)},className:"input pl-9",placeholder:"Search by name..."})]}),e.jsxs("select",{value:n,onChange:s=>{N(s.target.value),d(1)},className:"select w-auto",children:[e.jsx("option",{value:"all",children:"All Roles"}),e.jsx("option",{value:"customer",children:"Customers"}),e.jsx("option",{value:"admin",children:"Admins"})]})]}),e.jsx("div",{className:"table-container",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"User"}),e.jsx("th",{children:"Username"}),e.jsx("th",{children:"Phone"}),e.jsx("th",{children:"Role"}),e.jsx("th",{children:"Joined"}),e.jsx("th",{className:"text-right",children:"Actions"})]})}),e.jsxs("tbody",{children:[u&&e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"text-center py-12 text-muted-foreground",children:"Loading..."})}),!u&&m.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"text-center py-12 text-muted-foreground",children:"No users found."})}),m.map(s=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-primary/20 border border-primary/30 flex items-center justify-center shrink-0",children:s.avatar_url?e.jsx("img",{src:s.avatar_url,alt:"",className:"w-full h-full rounded-full object-cover"}):e.jsx("span",{className:"text-primary text-xs font-bold",children:s.full_name?.charAt(0)??"?"})}),e.jsx("p",{className:"text-sm font-medium text-foreground",children:s.full_name})]})}),e.jsx("td",{children:e.jsxs("span",{className:"text-sm text-muted-foreground",children:["@",s.username??"—"]})}),e.jsx("td",{children:e.jsx("span",{className:"text-sm text-muted-foreground",children:s.phone_number??"—"})}),e.jsx("td",{children:e.jsx("span",{className:S("badge",s.role==="admin"?"bg-primary/20 text-primary border-primary/30":"bg-secondary text-muted-foreground border-border"),children:s.role})}),e.jsx("td",{children:e.jsx("span",{className:"text-xs text-muted-foreground",children:_(s.created_at)})}),e.jsx("td",{children:e.jsxs("div",{className:"flex items-center gap-1 justify-end",children:[e.jsx("button",{onClick:()=>b(s),className:"btn-ghost btn-icon",title:s.role==="admin"?"Revoke admin":"Make admin",children:s.role==="admin"?e.jsx(U,{size:15,className:"text-destructive/70"}):e.jsx(z,{size:15,className:"text-muted-foreground"})}),e.jsx(k,{to:`/users/${s.user_id}`,className:"btn-ghost btn-icon",title:"View details",children:e.jsx(w,{size:15})})]})})]},s.user_id))]})]})}),o>1&&e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("p",{className:"text-muted-foreground",children:["Showing ",(a-1)*c+1,"–",Math.min(a*c,r)," of ",r]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>d(s=>Math.max(1,s-1)),disabled:a===1,className:"btn-secondary px-3 py-1.5 text-xs",children:"Prev"}),e.jsx("button",{onClick:()=>d(s=>Math.min(o,s+1)),disabled:a===o,className:"btn-secondary px-3 py-1.5 text-xs",children:"Next"})]})]})]})}export{A as default};
