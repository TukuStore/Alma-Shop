import{c as m,a as c,j as e,L as l,f as i,k as x,e as h,z as u}from"./index-B7VyGmnV.js";import{g as y,d as _,t as b}from"./voucherService-CtTkvSPo.js";import{P as k,S as w}from"./square-pen-DGeCmu33.js";import{T as V}from"./trash-2-erq2rAW7.js";const L=[["circle",{cx:"9",cy:"12",r:"3",key:"u3jwor"}],["rect",{width:"20",height:"14",x:"2",y:"5",rx:"7",key:"g7kal2"}]],S=m("toggle-left",L);const z=[["circle",{cx:"15",cy:"12",r:"3",key:"1afu0r"}],["rect",{width:"20",height:"14",x:"2",y:"5",rx:"7",key:"g7kal2"}]],D=m("toggle-right",z);function E(){const[n,r]=c.useState([]),[d,g]=c.useState(!0),j=c.useCallback(()=>{y().then(r).finally(()=>g(!1))},[]);c.useEffect(()=>{j()},[]);const f=async(t,a)=>{confirm(`Delete voucher "${a}"?`)&&(await _(t),u.success("Voucher deleted"),r(s=>s.filter(N=>N.id!==t)))},p=async t=>{await b(t.id,!t.is_active),u.success(`Voucher ${t.is_active?"deactivated":"activated"}`),r(a=>a.map(s=>s.id===t.id?{...s,is_active:!t.is_active}:s))},o=t=>t.end_date?new Date(t.end_date)<new Date:!1;return e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"page-header mb-0",children:"Vouchers"}),e.jsxs(l,{to:"/vouchers/new",className:"btn-primary",children:[e.jsx(k,{size:16})," New Voucher"]})]}),e.jsx("div",{className:"table-container",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Code"}),e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Discount"}),e.jsx("th",{children:"Min Purchase"}),e.jsx("th",{children:"Validity"}),e.jsx("th",{children:"Status"}),e.jsx("th",{className:"text-right",children:"Actions"})]})}),e.jsxs("tbody",{children:[d&&e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"text-center py-12 text-muted-foreground",children:"Loading..."})}),!d&&n.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"text-center py-12 text-muted-foreground",children:"No vouchers created yet."})}),n.map(t=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("span",{className:"font-mono text-sm font-bold text-primary",children:t.code})}),e.jsx("td",{children:e.jsx("p",{className:"text-sm text-foreground",children:t.name})}),e.jsxs("td",{children:[e.jsx("p",{className:"text-sm font-semibold text-foreground",children:t.discount_type==="percentage"?`${t.discount_value}%`:i(t.discount_value)}),t.max_discount&&t.discount_type==="percentage"&&e.jsxs("p",{className:"text-[10px] text-muted-foreground",children:["max ",i(t.max_discount)]})]}),e.jsx("td",{children:e.jsx("span",{className:"text-sm text-muted-foreground",children:i(t.min_purchase)})}),e.jsxs("td",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:t.start_date?x(t.start_date):"—"}),e.jsxs("p",{className:h("text-xs",o(t)?"text-red-400":"text-muted-foreground"),children:["→ ",t.end_date?x(t.end_date):"No expiry",o(t)&&" (expired)"]})]}),e.jsx("td",{children:e.jsx("span",{className:h("badge",t.is_active?"bg-green-500/20 text-green-400 border-green-500/30":"bg-red-500/20 text-red-400 border-red-500/30"),children:t.is_active?"Active":"Inactive"})}),e.jsx("td",{children:e.jsxs("div",{className:"flex items-center gap-1 justify-end",children:[e.jsx("button",{onClick:()=>p(t),className:"btn-ghost btn-icon",title:"Toggle active",children:t.is_active?e.jsx(D,{size:17,className:"text-green-400"}):e.jsx(S,{size:17})}),e.jsx(l,{to:`/vouchers/${t.id}/edit`,className:"btn-ghost btn-icon",children:e.jsx(w,{size:15})}),e.jsx("button",{onClick:()=>f(t.id,t.code),className:"btn-ghost btn-icon text-destructive/70 hover:text-destructive",children:e.jsx(V,{size:15})})]})})]},t.id))]})]})})]})}export{E as default};
