import{c as C,a as i,j as e,z as c}from"./index-B7VyGmnV.js";import{g as b,u as x,a as w}from"./categoryService-xXKv2Z8A.js";import{L as p}from"./loader-circle-DVE6fxfl.js";import{U as I}from"./upload-CeYHQV_O.js";const S=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],z=C("pen",S);function U(){const[h,n]=i.useState([]),[f,l]=i.useState(null),[r,d]=i.useState(""),[m,u]=i.useState(null),[j,y]=i.useState(!0);i.useEffect(()=>{b().then(s=>{n(s),y(!1)})},[]);const g=async s=>{await x(s,{name:r}),n(a=>a.map(t=>t.id===s?{...t,name:r}:t)),l(null),c.success("Category updated")},N=async(s,a)=>{u(s);try{const t=await w(a,s);await x(s,{image_url:t}),n(v=>v.map(o=>o.id===s?{...o,image_url:t}:o)),c.success("Category image updated")}catch{c.error("Upload failed")}finally{u(null)}};return j?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(p,{size:32,className:"animate-spin text-primary"})}):e.jsxs("div",{className:"space-y-5",children:[e.jsx("h1",{className:"page-header",children:"Categories"}),e.jsx("p",{className:"text-sm text-muted-foreground -mt-3",children:"Manage the 8 Sarung product categories. You can update the name and cover image."}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:h.map(s=>e.jsxs("div",{className:"card p-0 overflow-hidden",children:[e.jsxs("div",{className:"relative aspect-[4/3] bg-secondary",children:[s.image_url?e.jsx("img",{src:s.image_url,alt:s.name,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center text-muted-foreground text-xs",children:"No image"}),e.jsxs("label",{className:`absolute inset-0 flex items-center justify-center bg-black/50 opacity-0
                               hover:opacity-100 transition-opacity cursor-pointer ${m===s.id?"opacity-100":""}`,children:[m===s.id?e.jsx(p,{size:24,className:"text-white animate-spin"}):e.jsxs(e.Fragment,{children:[e.jsx(I,{size:20,className:"text-white"}),e.jsx("span",{className:"text-white text-xs ml-2",children:"Change Image"})]}),e.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:a=>{a.target.files?.[0]&&N(s.id,a.target.files[0])}})]})]}),e.jsxs("div",{className:"p-3",children:[f===s.id?e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{value:r,onChange:a=>d(a.target.value),className:"input text-sm py-1 flex-1",autoFocus:!0,onKeyDown:a=>{a.key==="Enter"&&g(s.id),a.key==="Escape"&&l(null)}}),e.jsx("button",{onClick:()=>g(s.id),className:"btn-primary px-2 py-1 text-xs",children:"Save"})]}):e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-sm font-semibold text-foreground",children:s.name}),e.jsx("button",{onClick:()=>{l(s.id),d(s.name)},className:"btn-ghost btn-icon",children:e.jsx(z,{size:13})})]}),e.jsx("p",{className:"text-[10px] text-muted-foreground mt-0.5",children:s.slug})]})]},s.id))})]})}export{U as default};
