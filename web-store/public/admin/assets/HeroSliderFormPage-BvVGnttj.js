import{u as k,m as L,a as n,z as c,j as e,L as f}from"./index-B7VyGmnV.js";import{u as z,a as C,o as F,p as H,n as I,s as m,c as A,b as B}from"./schemas-DS6lUYcu.js";import{a as R,b as E,u as T,c as U}from"./heroSliderService-Jc4g4_1K.js";import{L as g}from"./loader-circle-DVE6fxfl.js";import{A as P}from"./arrow-left-CyqdG89q.js";import{U as D}from"./upload-CeYHQV_O.js";import{S as q}from"./save-D7_vrgA4.js";const O=a=>a===""||a===null||a===void 0?void 0:Number(a),G=F({title:m().min(1,"Title is required"),type:A(["home","flash_sale"]),subtitle:m().optional(),cta_text:m().optional(),cta_link:m().optional(),sort_order:H(O,I().min(0)),is_active:B()});function Y(){const{id:a}=k(),l=!!a,o=L(),[N,v]=n.useState(l),[h,p]=n.useState(!1),[x,y]=n.useState(null),[u,b]=n.useState(null),{register:t,handleSubmit:S,formState:{errors:d},reset:j}=z({resolver:C(G),defaultValues:{title:"",type:"home",subtitle:"",cta_text:"",cta_link:"",sort_order:0,is_active:!0}});n.useEffect(()=>{l&&R(a).then(s=>{if(!s){c.error("Slider not found"),o("/hero-sliders");return}j({title:s.title,type:s.type||"home",subtitle:s.subtitle||"",cta_text:s.cta_text||"",cta_link:s.cta_link||"",sort_order:s.sort_order,is_active:s.is_active}),b(s.image_url)}).catch(()=>{c.error("Slider not found"),o("/hero-sliders")}).finally(()=>v(!1))},[a,l,j,o]);const _=s=>{const r=s.target.files?.[0];if(!r)return;y(r);const i=new FileReader;i.onloadend=()=>b(i.result),i.readAsDataURL(r)},w=async s=>{try{if(p(!0),!l&&!x){c.error("Banner image is required"),p(!1);return}let r=u;x&&(r=await E(x));const i={...s,image_url:r};l?(await T(a,i),c.success("Slider updated globally")):(await U(i),c.success("Slider created globally")),o("/hero-sliders")}catch(r){c.error(r.message||"Failed to save slider")}finally{p(!1)}};return N?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx(g,{size:32,className:"animate-spin text-primary"})}):e.jsxs("div",{className:"max-w-2xl space-y-5 pb-10",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(f,{to:"/hero-sliders",className:"btn-ghost btn-icon p-2 -ml-2",children:e.jsx(P,{size:20})}),e.jsx("h1",{className:"page-header mb-0",children:l?"Edit Hero Slider":"New Hero Slider"})]}),e.jsxs("form",{onSubmit:S(w),className:"space-y-6",children:[e.jsxs("div",{className:"card",children:[e.jsx("h2",{className:"text-sm font-semibold mb-4",children:"Banner Image"}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"w-full aspect-[21/9] bg-secondary rounded-xl border-2 border-dashed border-border overflow-hidden relative flex items-center justify-center",children:[u?e.jsx("img",{src:u,className:"w-full h-full object-cover",alt:"Preview"}):e.jsxs("div",{className:"text-center text-muted-foreground p-4",children:[e.jsx(D,{size:24,className:"mx-auto mb-2 opacity-50"}),e.jsx("p",{className:"text-sm",children:"Click to upload banner image"}),e.jsx("p",{className:"text-xs mt-1",children:"Recommended size: 1000x400 (or wider)"})]}),e.jsx("input",{type:"file",accept:"image/*",className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer",onChange:_})]})})]}),e.jsxs("div",{className:"card space-y-4",children:[e.jsx("h2",{className:"text-sm font-semibold mb-2",children:"Content"}),e.jsxs("div",{className:"form-group mb-4",children:[e.jsxs("label",{className:"label",children:["Banner Type ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsxs("div",{className:"flex items-center gap-6 mt-2",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"radio",value:"home",...t("type"),className:"w-4 h-4 text-primary"}),e.jsx("span",{className:"text-sm",children:"Home Banner"})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"radio",value:"flash_sale",...t("type"),className:"w-4 h-4 text-primary"}),e.jsx("span",{className:"text-sm",children:"Flash Sale Banner"})]})]}),d.type&&e.jsx("p",{className:"text-xs text-destructive mt-1",children:d.type.message})]}),e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{className:"label",children:["Title ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx("input",{...t("title"),className:"input",placeholder:"e.g. Ramadan Sale Up to 50% Off"}),d.title&&e.jsx("p",{className:"text-xs text-destructive",children:d.title.message})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"label",children:"Subtitle"}),e.jsx("input",{...t("subtitle"),className:"input",placeholder:"e.g. Exclusive deals, limited stock!"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"label",children:"CTA Text"}),e.jsx("input",{...t("cta_text"),className:"input",placeholder:"e.g. Grab Deals"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"label",children:"CTA Link (URL or Route)"}),e.jsx("input",{...t("cta_link"),className:"input",placeholder:"e.g. /(tabs)/categories"})]})]})]}),e.jsxs("div",{className:"card space-y-4",children:[e.jsx("h2",{className:"text-sm font-semibold mb-2",children:"Display Settings"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"label",children:"Sort Order"}),e.jsx("input",{type:"number",...t("sort_order"),className:"input",placeholder:"0"}),e.jsx("p",{className:"text-[10px] text-muted-foreground mt-1",children:"Lower numbers appear first"})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-7",children:[e.jsx("input",{type:"checkbox",id:"is_active",...t("is_active"),className:"w-4 h-4 rounded border-input bg-background"}),e.jsx("label",{htmlFor:"is_active",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"Active (Show on App)"})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-border",children:[e.jsx(f,{to:"/hero-sliders",className:"btn-secondary px-6",children:"Cancel"}),e.jsxs("button",{type:"submit",disabled:h,className:"btn-primary px-6",children:[h?e.jsx(g,{size:16,className:"animate-spin"}):e.jsx(q,{size:16}),"Save Slider"]})]})]})]})}export{Y as default};
